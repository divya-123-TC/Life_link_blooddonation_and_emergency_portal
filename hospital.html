<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>LifeLink â€” Hospitals</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div class="header-bar">
    <img src="images/small_logo.png" alt="LifeLink" class="logo">
    <div class="header-title">Partner Hospitals</div>
  </div>

  <div class="nav">
    <a href="index.html">Home</a>
    <a href="register.html">Register</a>
    <a href="find.html">Find Donor</a>
    <a href="emergency.html">Emergency</a>
    <a href="camp.html">Camps</a>
    <a href="hospital.html" class="active">Hospitals</a>
    <a href="contact.html">Contact</a>
    <a href="admin_login.html">Admin Login</a>
  </div>

  <div class="container">
    <div class="section">
      <div class="text">
        <h2>Hospitals with Blood Banks</h2>
        <p class="lead">Call any hospital directly for blood availability or emergency help.</p>

        <!-- Approved hospitals list (only approved are shown) -->
        <div id="hosp_list"></div>

        <h3 style="margin-top:20px">Request to Add Hospital (will require admin approval)</h3>
        <div class="form-card">
          <form id="hForm">
            <input id="h_name" placeholder="Hospital name" required />
            <input id="h_city" placeholder="City" required />
            <input id="h_contact" placeholder="Contact number" required />
            <input id="h_groups" placeholder="Available groups (comma separated)" />
            <button type="submit" class="btn">Request Add Hospital</button>
          </form>
          <p id="h_success" class="success-msg"></p>
        </div>

        <p class="slogan">â€œHospitals and donors together save lives.â€</p>
      </div>

      <img class="side-img" src="images/hospital.jpeg" alt="Hospital">
    </div>
  </div>

  <div class="footer">Â© 2025 LifeLink</div>

  <script>
    // Helper
    const $ = id => document.getElementById(id);

    // Show only approved hospitals from 'hospitals' key
    function displayHospitals() {
      const wrap = $("hosp_list");
      wrap.innerHTML = "";
      const hospitals = JSON.parse(localStorage.getItem("hospitals")) || [];

      if (hospitals.length === 0) {
        wrap.innerHTML = '<p>No hospitals listed yet.</p>';
        return;
      }

      hospitals.forEach(h => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${h.name}</h3>
          <p>ğŸ“ ${h.city}</p>
          <p>â˜ ${h.contact}</p>
          <p>ğŸ’‰ Blood Groups: ${h.groups || "â€”"}</p>
          <a href="tel:${h.contact}" class="btn call-btn">ğŸ“ Call Now</a>
        `;
        wrap.appendChild(card);
      });
    }

    // Submit request -> saved to pending_hospitals
    if ($("hForm")) {
      $("hForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const hospital = {
          name: $("h_name").value.trim(),
          city: $("h_city").value.trim(),
          contact: $("h_contact").value.trim(),
          groups: $("h_groups").value.trim(),
          requestedAt: new Date().toISOString()
        };
        if (!hospital.name || !hospital.city || !hospital.contact) {
          $("h_success").textContent = "Please fill name, city and contact.";
          $("h_success").style.color = "red";
          setTimeout(()=> $("h_success").textContent = "", 3000);
          return;
        }

        const pending = JSON.parse(localStorage.getItem("pending_hospitals")) || [];
        pending.push(hospital);
        localStorage.setItem("pending_hospitals", JSON.stringify(pending));

        $("h_success").textContent = "âœ… Request submitted â€” waiting admin approval.";
        $("h_success").style.color = "green";
        $("hForm").reset();
        setTimeout(()=> $("h_success").textContent = "", 3500);
      });
    }

    // Initial render of approved hospitals
    displayHospitals();
  </script>
</body>
</html>
